<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”µåŠ›ç”µç½‘æ•°æ®åœ°å›¾å±•ç¤ºç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background-color: #2c3e50;
            color: white;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 500;
        }

        .container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .map-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .map {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
        }

        .legend {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            min-width: 150px;
            backdrop-filter: blur(5px);
            z-index: 1000;
        }

        .legend h4 {
            margin: 0 0 12px 0;
            font-size: 14px;
            font-weight: 600;
            color: #2c3e50;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 12px;
            color: #34495e;
        }

        .legend-item:last-child {
            margin-bottom: 0;
        }

        .legend-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 8px;
            border: 2px solid #fff;
        }

        .legend-icon.power-plant {
            background-color: #ff6600;
        }

        .legend-icon.substation {
            background-color: #0066ff;
        }

        .legend-icon.transmission {
            background-color: #ff3300;
        }

        .marker {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            border: 3px solid white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
        }

        .marker:hover {
            transform: scale(1.2);
            z-index: 1000;
        }

        .marker.power-plant {
            background-color: #ff6600;
        }

        .marker.substation {
            background-color: #0066ff;
        }

        .marker.transmission {
            background-color: #ff3300;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 0 0 0 rgba(255, 255, 255, 0.7);
            }
            70% {
                box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 0 0 10px rgba(255, 255, 255, 0);
            }
            100% {
                box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 0 0 0 rgba(255, 255, 255, 0);
            }
        }

        .info-popup {
            position: absolute;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            min-width: 250px;
            z-index: 2000;
            display: none;
            border: 1px solid #ddd;
        }

        .info-popup h3 {
            margin: 0 0 12px 0;
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            border-bottom: 1px solid #ecf0f1;
            padding-bottom: 8px;
        }

        .info-popup p {
            margin: 8px 0;
            font-size: 13px;
            color: #34495e;
            line-height: 1.4;
        }

        .status {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .status.æ­£å¸¸ {
            background-color: #d4edda;
            color: #155724;
        }

        .status.ç»´æŠ¤ {
            background-color: #fff3cd;
            color: #856404;
        }

        .status.æ•…éšœ {
            background-color: #f8d7da;
            color: #721c24;
        }

        .status.åœè¿ {
            background-color: #f8f9fa;
            color: #6c757d;
        }

        .close-btn {
            position: absolute;
            top: 5px;
            right: 10px;
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: #999;
        }

        .stats {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(5px);
        }

        .stats h4 {
            margin: 0 0 8px 0;
            font-size: 14px;
            color: #2c3e50;
        }

        .stats div {
            font-size: 12px;
            color: #34495e;
            margin-bottom: 4px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ç”µåŠ›ç”µç½‘æ•°æ®åœ°å›¾å±•ç¤ºç³»ç»Ÿ</h1>
    </div>
    
    <div class="container">
        <div class="map-container">
            <div class="map" id="map">
                <!-- å›¾ä¾‹ -->
                <div class="legend">
                    <h4>å›¾ä¾‹</h4>
                    <div class="legend-item">
                        <div class="legend-icon power-plant"></div>
                        <span>å‘ç”µå‚</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-icon substation"></div>
                        <span>å˜ç”µç«™</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-icon transmission"></div>
                        <span>è¾“ç”µçº¿è·¯</span>
                    </div>
                </div>

                <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                <div class="stats">
                    <h4>ç³»ç»Ÿç»Ÿè®¡</h4>
                    <div>æ€»è®¾æ–½: <span id="total-count">12</span></div>
                    <div>æ­£å¸¸è¿è¡Œ: <span id="normal-count">8</span></div>
                    <div>ç»´æŠ¤ä¸­: <span id="maintenance-count">1</span></div>
                    <div>æ•…éšœ: <span id="fault-count">1</span></div>
                    <div>åœè¿: <span id="offline-count">1</span></div>
                </div>

                <!-- ä¿¡æ¯å¼¹çª— -->
                <div class="info-popup" id="info-popup">
                    <button class="close-btn" onclick="closePopup()">Ã—</button>
                    <div id="popup-content"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ç”µåŠ›ç”µç½‘æ•°æ®
        const powerGridData = [
            {
                id: 1,
                name: 'åŒ—äº¬ç¬¬ä¸€çƒ­ç”µå‚',
                type: 'å‘ç”µå‚',
                x: 20,
                y: 15,
                capacity: '500MW',
                status: 'æ­£å¸¸',
                load: '85%',
                address: 'åŒ—äº¬å¸‚æœé˜³åŒº',
                icon: 'âš¡'
            },
            {
                id: 2,
                name: 'æœé˜³å˜ç”µç«™',
                type: 'å˜ç”µç«™',
                x: 40,
                y: 25,
                capacity: '220KV',
                status: 'æ­£å¸¸',
                load: '78%',
                address: 'åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯',
                icon: 'ğŸ”Œ'
            },
            {
                id: 3,
                name: 'æµ·æ·€å˜ç”µç«™',
                type: 'å˜ç”µç«™',
                x: 15,
                y: 35,
                capacity: '110KV',
                status: 'ç»´æŠ¤',
                load: '45%',
                address: 'åŒ—äº¬å¸‚æµ·æ·€åŒºä¸­å…³æ‘',
                icon: 'ğŸ”Œ'
            },
            {
                id: 4,
                name: 'å¤§å…´ç‡ƒæ°”ç”µå‚',
                type: 'å‘ç”µå‚',
                x: 25,
                y: 65,
                capacity: '800MW',
                status: 'æ­£å¸¸',
                load: '92%',
                address: 'åŒ—äº¬å¸‚å¤§å…´åŒº',
                icon: 'âš¡'
            },
            {
                id: 5,
                name: 'ä¸œåŸè¾“ç”µçº¿è·¯1',
                type: 'è¾“ç”µçº¿è·¯',
                startPoint: { x: 20, y: 15, name: 'åŒ—äº¬ç¬¬ä¸€çƒ­ç”µå‚' },
                endPoint: { x: 40, y: 25, name: 'æœé˜³å˜ç”µç«™' },
                capacity: '500KV',
                status: 'æ­£å¸¸',
                load: '67%',
                address: 'åŒ—äº¬å¸‚ä¸œåŸåŒº',
                icon: 'ğŸ”—'
            },
            {
                id: 6,
                name: 'ä¸°å°å˜ç”µç«™',
                type: 'å˜ç”µç«™',
                x: 30,
                y: 55,
                capacity: '220KV',
                status: 'æ­£å¸¸',
                load: '73%',
                address: 'åŒ—äº¬å¸‚ä¸°å°åŒº',
                icon: 'ğŸ”Œ'
            },
            {
                id: 7,
                name: 'é€šå·é£ç”µåœº',
                type: 'å‘ç”µå‚',
                x: 70,
                y: 30,
                capacity: '200MW',
                status: 'æ­£å¸¸',
                load: '58%',
                address: 'åŒ—äº¬å¸‚é€šå·åŒº',
                icon: 'âš¡'
            },
            {
                id: 8,
                name: 'è¥¿åŸè¾“ç”µçº¿è·¯2',
                type: 'è¾“ç”µçº¿è·¯',
                startPoint: { x: 15, y: 35, name: 'æµ·æ·€å˜ç”µç«™' },
                endPoint: { x: 30, y: 55, name: 'ä¸°å°å˜ç”µç«™' },
                capacity: '220KV',
                status: 'æ•…éšœ',
                load: '0%',
                address: 'åŒ—äº¬å¸‚è¥¿åŸåŒº',
                icon: 'ğŸ”—'
            },
            {
                id: 9,
                name: 'æ˜Œå¹³å˜ç”µç«™',
                type: 'å˜ç”µç«™',
                x: 10,
                y: 10,
                capacity: '110KV',
                status: 'æ­£å¸¸',
                load: '56%',
                address: 'åŒ—äº¬å¸‚æ˜Œå¹³åŒº',
                icon: 'ğŸ”Œ'
            },
            {
                id: 10,
                name: 'é¡ºä¹‰å¤ªé˜³èƒ½ç”µç«™',
                type: 'å‘ç”µå‚',
                x: 75,
                y: 15,
                capacity: '100MW',
                status: 'æ­£å¸¸',
                load: '65%',
                address: 'åŒ—äº¬å¸‚é¡ºä¹‰åŒº',
                icon: 'âš¡'
            },
            {
                id: 11,
                name: 'æˆ¿å±±è¾“ç”µçº¿è·¯3',
                type: 'è¾“ç”µçº¿è·¯',
                startPoint: { x: 25, y: 65, name: 'å¤§å…´ç‡ƒæ°”ç”µå‚' },
                endPoint: { x: 30, y: 55, name: 'ä¸°å°å˜ç”µç«™' },
                capacity: '110KV',
                status: 'æ­£å¸¸',
                load: '71%',
                address: 'åŒ—äº¬å¸‚æˆ¿å±±åŒº',
                icon: 'ğŸ”—'
            },
            {
                id: 12,
                name: 'å¯†äº‘å˜ç”µç«™',
                type: 'å˜ç”µç«™',
                x: 80,
                y: 5,
                capacity: '220KV',
                status: 'åœè¿',
                load: '0%',
                address: 'åŒ—äº¬å¸‚å¯†äº‘åŒº',
                icon: 'ğŸ”Œ'
            }
        ];

        // åˆå§‹åŒ–åœ°å›¾
        function initMap() {
            const map = document.getElementById('map');
            
            powerGridData.forEach(item => {
                if (item.type === 'è¾“ç”µçº¿è·¯') {
                    // ç»˜åˆ¶è¾“ç”µçº¿è·¯
                    drawTransmissionLine(item, map);
                } else {
                    // ç»˜åˆ¶è®¾æ–½ç‚¹ä½
                    drawFacilityMarker(item, map);
                }
            });

            updateStats();
        }

        // ç»˜åˆ¶è®¾æ–½æ ‡è®°
        function drawFacilityMarker(item, map) {
            const marker = document.createElement('div');
            marker.className = `marker ${getTypeClass(item.type)}`;
            marker.style.left = `${item.x}%`;
            marker.style.top = `${item.y}%`;
            marker.innerHTML = item.icon;
            marker.onclick = () => showInfo(item, marker);
            
            map.appendChild(marker);
        }

        // ç»˜åˆ¶è¾“ç”µçº¿è·¯
        function drawTransmissionLine(lineData, map) {
            // è®¡ç®—çº¿è·¯å‚æ•°
            const dx = lineData.endPoint.x - lineData.startPoint.x;
            const dy = lineData.endPoint.y - lineData.startPoint.y;
            const length = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * 180 / Math.PI;
            
            // æ ¹æ®çŠ¶æ€è®¾ç½®çº¿è·¯é¢œè‰²
            const lineColor = lineData.status === 'æ•…éšœ' ? '#ff0000' : '#00ff00';
            const lineStyle = lineData.status === 'æ•…éšœ' ? 'dashed' : 'solid';
            
            // åˆ›å»ºçº¿è·¯å…ƒç´ 
            const lineEl = document.createElement('div');
            lineEl.style.cssText = `
                position: absolute;
                left: ${lineData.startPoint.x}%;
                top: ${lineData.startPoint.y}%;
                width: ${length}%;
                height: 6px;
                background: ${lineColor};
                border-radius: 3px;
                transform-origin: 0 50%;
                transform: rotate(${angle}deg);
                cursor: pointer;
                z-index: 5;
                ${lineStyle === 'dashed' ? 'border: 3px dashed ' + lineColor + '; background: transparent;' : ''}
            `;
            
            lineEl.onclick = () => showInfo(lineData, lineEl);
            map.appendChild(lineEl);
            
            // åœ¨çº¿è·¯ä¸­ç‚¹æ·»åŠ æ ‡è¯†å›¾æ ‡
            const midX = (lineData.startPoint.x + lineData.endPoint.x) / 2;
            const midY = (lineData.startPoint.y + lineData.endPoint.y) / 2;
            
            const lineLabelEl = document.createElement('div');
            lineLabelEl.className = 'marker transmission';
            lineLabelEl.style.cssText = `
                position: absolute;
                left: ${midX}%;
                top: ${midY}%;
                width: 30px;
                height: 30px;
                background: #ff3300;
                border-radius: 50%;
                border: 2px solid white;
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 14px;
                cursor: pointer;
                box-shadow: 0 4px 8px rgba(0,0,0,0.3);
                z-index: 15;
            `;
            lineLabelEl.innerHTML = 'ğŸ”—';
            lineLabelEl.onclick = () => showInfo(lineData, lineLabelEl);
            
            map.appendChild(lineLabelEl);
        }

        // è·å–ç±»å‹æ ·å¼ç±»
        function getTypeClass(type) {
            const typeMap = {
                'å‘ç”µå‚': 'power-plant',
                'å˜ç”µç«™': 'substation',
                'è¾“ç”µçº¿è·¯': 'transmission'
            };
            return typeMap[type] || 'power-plant';
        }

        // æ˜¾ç¤ºè®¾æ–½ä¿¡æ¯
        function showInfo(item, marker) {
            const popup = document.getElementById('info-popup');
            const content = document.getElementById('popup-content');
            
            let infoContent = `
                <h3>${item.name}</h3>
                <p><strong>ç±»å‹:</strong> ${item.type}</p>
                <p><strong>å®¹é‡:</strong> ${item.capacity}</p>
                <p><strong>çŠ¶æ€:</strong> <span class="status ${item.status}">${item.status}</span></p>
                <p><strong>è´Ÿè·:</strong> ${item.load}</p>
            `;
            
            // å¦‚æœæ˜¯è¾“ç”µçº¿è·¯ï¼Œæ˜¾ç¤ºèµ·ç‚¹å’Œç»ˆç‚¹ä¿¡æ¯
            if (item.type === 'è¾“ç”µçº¿è·¯') {
                infoContent += `
                    <p><strong>èµ·ç‚¹:</strong> ${item.startPoint.name}</p>
                    <p><strong>ç»ˆç‚¹:</strong> ${item.endPoint.name}</p>
                `;
            }
            
            infoContent += `<p><strong>ä½ç½®:</strong> ${item.address}</p>`;
            
            content.innerHTML = infoContent;
            
            const rect = marker.getBoundingClientRect();
            const mapRect = document.getElementById('map').getBoundingClientRect();
            
            popup.style.left = `${rect.left - mapRect.left + 50}px`;
            popup.style.top = `${rect.top - mapRect.top - 20}px`;
            popup.style.display = 'block';
        }

        // å…³é—­å¼¹çª—
        function closePopup() {
            document.getElementById('info-popup').style.display = 'none';
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const stats = {
                total: powerGridData.length,
                normal: powerGridData.filter(item => item.status === 'æ­£å¸¸').length,
                maintenance: powerGridData.filter(item => item.status === 'ç»´æŠ¤').length,
                fault: powerGridData.filter(item => item.status === 'æ•…éšœ').length,
                offline: powerGridData.filter(item => item.status === 'åœè¿').length
            };

            document.getElementById('total-count').textContent = stats.total;
            document.getElementById('normal-count').textContent = stats.normal;
            document.getElementById('maintenance-count').textContent = stats.maintenance;
            document.getElementById('fault-count').textContent = stats.fault;
            document.getElementById('offline-count').textContent = stats.offline;
        }

        // ç‚¹å‡»åœ°å›¾ç©ºç™½å¤„å…³é—­å¼¹çª—
        document.getElementById('map').addEventListener('click', (e) => {
            if (e.target.id === 'map') {
                closePopup();
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åœ°å›¾
        window.onload = initMap;
    </script>
</body>
</html> 