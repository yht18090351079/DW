# 电力电网数据地图展示系统

一个功能完整的电力电网数据可视化管理系统，支持设备校验、异常监控、线损分析等高级功能。

## 🚀 新增功能特性

### 1. 设备信息校验与可视化 📋
- **自动校验**: 一键触发全网设备信息校验
- **错误标记**: 在地图上醒目显示校验错误设备
- **分类显示**: 区分错误级别（错误/警告）
- **详细信息**: 点击设备查看具体错误内容
- **打印支持**: 支持打印包含错误标记的地图

### 2. 表箱内部布局及状态模拟 🏠
- **内部视图**: 图形化展示表箱内电表分布
- **用户信息**: 显示户主姓名、设备ID
- **状态标注**: 电压异常、通信故障等突出显示
- **用户分类**: 居民用户、商业用户等分类展示

### 3. 中台电压数据集成与展示 ⚡
- **实时电压**: 显示当前电压值和状态
- **状态监控**: 正常、偏低、异常等状态指示
- **代表性数据**: 选择表箱中典型电表电压作为代表值

### 4. 线路详细属性展示 🔌
- **技术参数**: 导线型号、线径、敷设长度
- **安装信息**: 安装日期、制造商信息
- **运行状态**: 线路负荷、运行状态

### 5. 台区线损分析 📊
- **对比分析**: 理论线损 vs 实际线损
- **趋势图表**: 7天内线损变化曲线
- **多维度**: 支持日、周、月数据展示
- **可视化**: 柱状图直观显示损耗情况

### 6. 异常表计清单 ⚠️
- **集中管理**: 统一展示异常设备清单
- **分类显示**: 通信故障、长期不上线、数据错误
- **详细信息**: 表计编号、用户信息、最后上线时间
- **快速定位**: 点击清单项定位到地图位置

### 7. 客户欠费数据可视化 💰
- **欠费标记**: 地图上醒目显示欠费用户
- **金额信息**: 点击查看具体欠费金额
- **统计汇总**: 欠费用户数量统计

### 8. 台区图纸拼接打印功能 🖨️
- **分页打印**: 大范围地图自动分割为A3/A4页面
- **拼接标记**: 页码和重叠区域便于拼接
- **打印预览**: 动态生成打印预览
- **线下作业**: 满足现场作业需求

## 🎯 主要组件

### 地图显示
- **发电厂**: 橙色圆形标记 ⚡
- **变电站**: 蓝色圆形标记 🔌
- **输电线路**: 连接两点的线段 🔗
- **表箱**: 青色方形标记 📦

### 线路状态指示
- **正常**: 绿色实线
- **故障**: 红色虚线
- **维护**: 橙色实线
- **停运**: 灰色实线

### 校验错误标记
- **严重错误**: 红色警告标记 ❌
- **一般警告**: 橙色警告标记 ⚠️

## 🛠 技术架构

- **前端框架**: React 17.0.2
- **地图API**: 高德地图 1.4.15
- **UI组件**: 自定义CSS组件
- **数据格式**: JSON模拟数据
- **状态管理**: React Hooks

## 📦 安装与运行

```bash
# 安装依赖
npm install --legacy-peer-deps

# 启动开发服务器
npm start

# 项目将在 http://localhost:3000 启动
```

## 🔧 配置说明

### 高德地图API配置
```javascript
// public/index.html
<script src="https://webapi.amap.com/maps?v=1.4.15&key=YOUR_API_KEY"></script>
<script>
  window._AMapSecurityConfig = {
    securityJsCode: 'YOUR_SECURITY_CODE',
  }
</script>
```

### 数据结构
```javascript
// 设备数据示例
{
  id: 1,
  name: '北京第一热电厂',
  type: '发电厂',
  longitude: 116.397428,
  latitude: 39.90923,
  validationErrors: [
    { type: 'error', message: '设备编号不规范', field: 'equipmentCode' }
  ],
  voltageData: {
    current: 220.5,
    status: '正常'
  },
  loadData: {
    current: 425,
    history: [380, 420, 425, 430, 435]
  }
}
```

## 🎮 使用指南

### 设备校验
1. 点击"📋 设备校验"按钮
2. 系统自动扫描所有设备
3. 地图上显示错误标记
4. 点击标记查看详细错误信息
5. 使用"修复问题"按钮处理错误

### 异常表计管理
1. 点击"⚠️ 异常表计"按钮
2. 查看异常表计清单
3. 根据类型筛选表计
4. 点击表计项定位到地图

### 线损分析
1. 点击"📊 线损分析"按钮
2. 查看各台区线损对比图表
3. 分析理论值与实际值差异
4. 识别高损耗台区

### 打印功能
1. 点击"🖨️ 打印地图"按钮
2. 系统自动隐藏控制面板
3. 适配打印页面格式
4. 支持A3/A4分页打印

## 🔍 故障排除

### 高德地图API未加载
- 检查API Key是否正确
- 确认安全密钥配置
- 查看网络连接状态
- 系统会自动切换到演示模式

### 数据显示异常
- 检查数据格式是否正确
- 确认必要字段存在
- 查看浏览器控制台错误信息

### 9. 变电站负荷数据监控 📈
- **实时监控**: 显示变电站当前负荷状态
- **历史趋势**: 5天内负荷变化曲线图
- **统计分析**: 当前、平均、峰值负荷统计
- **多维度**: 支持不同时间维度查看

## 🎯 最新更新功能

### ✅ 已完善功能
1. **设备校验可视化** - 增加更多样例数据，错误标记与清单对应
2. **表箱内部布局** - 图形化界面，点击即显示，无需额外操作
3. **异常表计定位** - 清单项目可直接定位到地图位置
4. **用户分类展示** - 完整的用户分类和A/B/C相用电类型
5. **欠费数据可视化** - 地图标记欠费用户，显示具体金额
6. **负荷数据监控** - 变电站负荷曲线图和统计分析

## 📈 未来规划

- [ ] 实时数据接口集成
- [ ] 台区图纸拼接打印功能
- [ ] 移动端适配优化
- [ ] 数据导出功能
- [ ] 用户权限管理
- [ ] 历史数据回放
- [ ] 智能报警系统

## 📞 技术支持

如有问题，请检查：
1. Node.js版本 (推荐 v16+)
2. 高德地图API配置
3. 浏览器兼容性
4. 网络连接状态

---

🎉 **现在您可以访问 http://localhost:3000 体验完整的电力电网数据管理系统！** 